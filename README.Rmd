---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
  knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    fig.path = "man/figures/README-",
    out.width = "100%"
)
```

# `{fioRa}` `r golem::pkg_version()`

<!-- badges: start -->
[![Static Badge](https://img.shields.io/badge/LiveApp-blue)](https://apps.bam.de/shn01/fioRa/)
[![CRAN status](https://www.r-pkg.org/badges/version/fioRa)](https://CRAN.R-project.org/package=fioRa)
[![R-CMD-check](https://github.com/janlisec/fioRa/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/janlisec/fioRa/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/janlisec/fioRa/graph/badge.svg)](https://app.codecov.io/gh/janlisec/fioRa)
[![Static Badge](https://img.shields.io/badge/doi-10.1038/s41467--025--57422--4-yellow.svg)](https://doi.org/10.1038/s41467-025-57422-4)
<!-- badges: end -->

**FIORA** is an *in silico* fragmentation algorithm designed to predict tandem 
mass spectra (MS/MS) with high accuracy. Using a graph neural network, **FIORA** 
models bond cleavages, fragment intensities, and estimates retention times (RT) 
and collision cross section (CCS) values.

The original model and prediction algorithm is implemented in Python and can be
found at its [GitHub Repo](https://github.com/BAMeScience/fiora). The full 
description of the algorithm is published in a 
[Nature Communications article](https://doi.org/10.1038/s41467-025-57422-4).

The R package `{fioRa}` provides a wrapper for **FIORA**, to either run the 
Python script using the R function `run_script()` in the console or starting a 
Shiny-App using the R function `run_app()`.

Processing in the App is easy (simply paste a SMILES code to an input form and 
click a button). Also, result inspection is fun using annotated spectra plots. 
However, to limit computational time the app is limited to processing 10 compounds 
at once. For larger numbers please use `run_script()`.

## Installation

You can install the development version of `{fioRa}` from GitHub.

```{r, eval = FALSE}
install.packages("devtools")
devtools::install_github("janlisec/fioRa")
```

Before first use you need to set up a python installation and a conda 
environment *fiora* which can be achieved from within R with the help of 
the `reticulate` package and the convenience function `install_fiora()`.

```{r py_setup, eval = TRUE}
fioRa::install_fiora()
```

If a valid installation is found `install_fioRa()` will return a short list
providing the current OS, path of the python executable and fiora-predict script.

## Run

Now, you can launch the application as a Shiny-App.

```{r run_app, eval = FALSE}
fioRa::run_app()
```

![fioRa screenshot](dev/fioRa_screenshot.png?raw=true "fioRa screenshot")

Alternatively, you can use the exported function `run_script()` to work in the 
R console directly. This will accept R styled input parameters, generate an 
appropriate temporary **FIORA** input file, process it, and return an R styled 
list including the predicted MS/MS spectrum.

```{r run_script, eval = TRUE}
x <- data.frame(
  Name = "Example_0",
  SMILES = "CC1=CC(=O)OC2=CC(OS(O)(=O)=O)=CC=C12",
  Precursor_type = "[M-H]-",
  CE = 17,
  Instrument_type = "HCD"
)
fioRa::run_script(x = x, annotation = TRUE)
```

## About

You are reading the doc about version `r golem::pkg_version()` compiled on `r Sys.time() `.
